<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Web - Advanced Video Player</title>
    <!-- Include plyr CSS -->
    <link rel="stylesheet" href="https://cdn.plyr.io/3.6.3/plyr.css" />
</head>
<body>
    <!-- Video player container -->
    <div id="video-container">
        <video id="my-video" controls crossorigin>
            <!-- HLS video source -->
            <source id="video-source" src="" type="application/x-mpegURL">
            Your browser does not support the video tag.
        </video>
    </div>

    <!-- M3U8 input and play button -->
    <input type="text" id="m3u8-placeholder" placeholder="Enter HLS URL">
    <button id="play-btn">Play</button>

    <!-- Include plyr JS -->
    <script src="https://cdn.plyr.io/3.6.3/plyr.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script>
        $(window).on('load', function () {
            // Initialize plyr video player
            const player = new Plyr('#my-video');

            // Set the initial HLS URL from local storage
            $('#m3u8-placeholder').val(localStorage.getItem('m3u8-link') || '');

            // Click event for the play button
            $('#play-btn').on('click', function () {
                // Save HLS URL to local storage
                const m3u8Link = $('#m3u8-placeholder').val();
                localStorage.setItem('m3u8-link', m3u8Link);

                // Update video source and play
                player.source = {
                    type: 'video',
                    sources: [
                        {
                            src: m3u8Link,
                            type: 'application/x-mpegURL',
                        },
                    ],
                };
                player.play();

                // Update the URL hash
                window.location.hash = '#video_' + m3u8Link;
            });
        });
    </script>
</body>
</html>
